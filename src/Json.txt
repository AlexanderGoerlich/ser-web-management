SET task = ´
{
	tasks: [
	{
		reports: [
		{
			# Connection settings to Qlik Desktop or Server
			connections:
			{
				app: a8515873-3c32-4bf1-a95d-fedcf197a842
			}

			# Template Settings
			template: 
			{
				input: content://$cont-_(my)'rice#{ohne}%&§!ß+~[ohne]/ExecutiveDashboard.xlsx
				output: ='Report_'&only(Region)&'_'&max([Fiscal Year])&'.pdf'
				#outputPassword:
				#'''
				#DIt5eEL4BitQk6tfQIgH2jGwJIsLtFxd8nNgoVsqFnJ8ivrnH+zeBtHQKD5tsUsMtpn6e3KE95s20cDuZ9KQ4k0006KfH4PYZjufs4KK1/tbtfIFRNpT/KIWJL
				#8wXdQC6Yv+xoQf0v4aRlErtNWh9o/TJOOvjbMkeeDTXqpwDRKoa4EHndWUzmCGMg/DXlilPmjeNZ7FG7c+X67jEpeWklE37Lrawag386apxdipKUuexbZ6OSZO
				#S2uDSHdnF0bjnfivwI9/jjH0M9nZAR7e1fiqvEkPLizR1vsRM8FEAW6uA5MuKODlSZGlnAentchodtaJH/FR6HdopN5dTywwJw==
				#'''

				selections:[
				{
					type: static
					name: Fiscal Year
					values: =[Fiscal Year]=(Year(ToDay())-4)
				}
				{
					type: dynamic
					name: Region
				}
				]
			}
			distribute:
			{
				# Mail Settings
				mail: 
				{
					active: false
                    mailType: markdown
					# Sample for Dymamic Subject
					subject: test
					message:
					'''
1. First ordered list item
2. Another item
⋅⋅* Unordered sub-list. 
1. Actual numbers don't matter, just that it's a number
⋅⋅1. Ordered sub-list
4. And another item.

⋅⋅⋅You can have properly indented paragraphs within list items. Notice the blank line above, and the leading spaces (at least one, but we'll use three here to also align the raw Markdown).

⋅⋅⋅To have a line break without a paragraph, you will need to use two trailing spaces.⋅⋅
⋅⋅⋅Note that this line is separate, but within the same paragraph.⋅⋅
⋅⋅⋅(This is contrary to the typical GFM line break behaviour, where trailing spaces are not required.)

* Unordered list can use asterisks
- Or minuses
+ Or pluses
                    '''

					# to, cc and bcc
					to: martin.berthold@akquinet.de
					mailServer: 
					{
						host: mail.senseexcel.com
						from: marcus.wuest@senseexcel.com
						port: 587
						username: marcus.wuest@senseexcel.com
						password: KtWWdGR0UR25ft65
						usessl: false
					}
				}

				# File Copy Settings
				file:
				{
					active: false
					target: lib://$cont-_(my)'rice#{ohne}%&§!ß+~[ohne]' (nb-fc-208000_mberthold)/Output/Demo
					mode: DeleteAllFirst
					connections: @CONFIGCONNECTION@
				}

				# Settings for upload in the Qlik hub
				hub: 
				{
					active: true
					# if owner is not defined, the system dirstribute to the owner of this APP
					#owner: USERDIRECTORY\USERNAME

					mode: DeleteAllFirst
					connections: @CONFIGCONNECTION@
				}
			}
		}
		]
	}
	]
}
´;

//Start reporting
Let resultWithTaskId = SER.START(task);
TRACE TaskId: $(resultWithTaskId);

//Show Versions
Let versions = SER.STATUS('versions: all');
TRACE Versions: $(versions);

//Wait for finish
Let Status = 0; 
Do while Status < 3 and Status > -1
  Let Result = SER.STATUS(resultWithTaskId);
  Let LogMsg = TextBetween(Result,'log":"','"}');
  Let Status = num#(TextBetween(Lower(Result),'status":','}'))+0;
  TRACE Status: $(Status) $(LogMsg);
  Sleep 2000;
Loop

TRACE $(Result);